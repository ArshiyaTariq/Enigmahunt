<html>
  <head>
    <title>Enigma Hunt</title>
    <script
    src="https://code.jquery.com/jquery-3.3.1.js"
    integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60="
    crossorigin="anonymous">
    </script>
    <link href="https://fonts.googleapis.com/css?family=Inconsolata|Pontano+Sans|Maven+Pro&subset=latin,latin-ext" rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="styles.css">
  </head>
  <body>
    <header>
      <nav>
          <a href="#" class="logo">
              <img src="logo.png" alt="logo" class="logo">
          </a>
          <ul>
              <li><a href="home.html">Home</a></li>
              <li><a href="about.html">About</a></li>
          </ul>
          <ul>
              <li><a href="help.html">Help?</a></li>
          </ul>
      </nav>
  </header>
  <script src="scripts.js"></script>
  <div id="sidebar">
    <div id="sidebar">
      <div id="sshinfo">
        <sh>SSH Information</sh><br>Host: enigmahunt.org<br>Port: 2222
      </div>
      <ul>
        <li>
          <a href="#"><sh>levels</sh></a>
        </li>
        <li><a class="selected" href="./index.html"></a></li>
        <li><a href="./level0-1.html">Level 0 → Level 1</a></li>
        <li><a href="./level1-2.html">Level 1 → Level 2</a></li>
        <li><a href="./level2-3.html">Level 2 → Level 3</a></li>
        <li><a href="./level3-4.html">Level 3 → Level 4</a></li>
        <li><a href="./level4-5.html">Level 4 → Level 5</a></li>
        <li><a href="./level5-6.html">Level 5 → Level 6</a></li>
        <li><a href="./level6-7.html">Level 6 → Level 7</a></li>
      </ul>
    </div>
  </div>  
    <div id="content">
      <div id="title"><h1>Level 6 → Level 7</h1></div>
      <h2 id="level-info">Level Info</h2>
      <p>Hopefully by now its obvious that encryption using repeating keys is
        a bad idea. Frequency analysis can destroy repeating/fixed key
      substitution crypto.</p>
      <p>A feature of good crypto is random ciphertext. A good cipher must
        not reveal any clues about the plaintext. Since natural language
        plaintext (in this case, English) contains patterns, it is left up
        to the encryption key or the encryption algorithm to add the
      ‘randomness’.</p>
      <p>Modern ciphers are similar to older plain substitution ciphers, but
      improve the ‘random’ nature of the key.</p>
      <p>An example of an older cipher using a complex, random, large key is
        a vigniere using a key of the same size of the plaintext. For
        example, imagine you and your confident have agreed on a key using
      the book ‘A Tale of Two Cities’ as your key, in 256 byte blocks.</p>
      <p>The cipher works as such:</p>
      <p>Each plaintext message is broken into 256 byte blocks. For each
        block of plaintext, a corresponding 256 byte block from the book is
        used as the key, starting from the first chapter, and progressing.
        No part of the book is ever re-used as key. The use of a key of the
        same length as the plaintext, and only using it once is called a
      “One Time Pad”.</p>
      <p>Look in the krypton6 directory. You will find a file called
        ‘plain1’, a 256 byte block. You will also see a file ‘key1’, the
        first 256 bytes of ‘A Tale of Two Cities’. The file ‘cipher1’ is the
        cipher text of plain1. As you can see (and try) it is very difficult
      to break the cipher without the key knowledge.</p>
      <p>If the encryption is truly random letters, and only used once, then
        it is impossible to break. A truly random “One Time Pad” key cannot
        be broken. Consider intercepting a ciphertext message of 1000 bytes.
        One could brute force for the key, but due to the random key nature,
        you would produce every single valid 1000 letter plaintext as well.
      Who is to know which is the real plaintext?!?</p>
      <p>Choosing keys that are the same size as the plaintext is
        impractical. Therefore, other methods must be used to obscure
        ciphertext against frequency analysis in a simple substitution
        cipher. The impracticality of an ‘infinite’ key means that the
        randomness, or entropy, of the encryption is introduced via the
      method.</p>
      <p>We have seen the method of ‘substitution’. Even in modern crypto,
        substitution is a valid technique. Another technique is
      ‘transposition’, or swapping of bytes.</p>
      <p>Modern ciphers break into two types; symmetric and asymmetric.</p>
      <p>Symmetric ciphers come in two flavours: block and stream.</p>
      <p>Until now, we have been playing with classical ciphers,
        approximating ‘block’ ciphers. A block cipher is done in fixed size
        blocks (suprise!). For example, in the previous paragraphs we
        discussed breaking text and keys into 256 byte blocks, and working
        on those blocks. Block ciphers use a fixed key to perform
      substituion and transposition ciphers on each block discretely.</p>
      <p>Its time to employ a stream cipher. A stream cipher attempts to
        create an on-the-fly ‘random’ keystream to encrypt the incoming
        plaintext one byte at a time. Typically, the ‘random’ key byte is
        xor’d with the plaintext to produce the ciphertext. If the random
        keystream can be replicated at the recieving end, then a further xor
      will produce the plaintext once again.</p>
      <p>From this example forward, we will be working with bytes, not ASCII
        text, so a hex editor/dumper like hexdump is a necessity. Now is the
        right time to start to learn to use tools like <a href="http://www.cryptool.com/">cryptool.</a></p>
        <p>In this example, the keyfile is in your directory, however it is not
          readable by you. The binary ‘encrypt6’ is also available. It will
          read the keyfile and encrypt any message you desire, using the key
          AND a ‘random’ number. You get to perform a ‘known ciphertext’
          attack by introducing plaintext of your choice. The challenge here
        is not simple, but the ‘random’ number generator is weak.</p>
        <p>As stated, it is now that we suggest you begin to use public tools,
          like cryptool, to help in your analysis. You will most likely need a
        hint to get going. See ‘HINT1’ if you need a kicktstart.</p>
        <p>If you have further difficulty, there is a hint in ‘HINT2’.</p>
        <p>The password for level 7 (krypton7) is encrypted with ‘encrypt6’.</p>
        <p>Good Luck!</p>
      </div>
    </body>
  </html>